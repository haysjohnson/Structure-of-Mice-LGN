%% load files

clear all;

expFileName = '18X12-revcor4-2P-3X-Erik-AxonG-8442-28Sep2021-clean';

fn = expFileName;
disp(['Loading ' fn]);
load(fn);

fn = [expFileName '-ROI'];
disp(['Loading ' fn]);
load(fn);

fn = [expFileName '-Stim'];
disp(['Loading ' fn]);
load(fn);

disp('Files loaded.');
%% create data for plotting (recorded earlier)
% 1-300
b1 = [4    6   28   30   37   39   41   51   55   59   64   67   73   81   83   84   86   94   97  100  103  104  105  110  111  112  114  122  126  128  130  132  133  135  136  141  143  148  149  150  155  157  158  163  168  172  182  183  190  191  195  200  203  207  208  211  212  215  216  217  218  222  229  230  232  233  242  245  248  250  251  254  256  262  268  272  274  275  276  277  280  284  287  290  294  296  298];
br1 = [0.53922     0.56994      1.5366      0.6535     0.95189     0.50375     0.54225     0.74842      1.4091     0.52696     0.78083     0.50295     0.69581       0.653     0.50383      1.2509     0.58469      1.0552     0.55226     0.57458      1.1415     0.52135     0.72534     0.53064     0.91352     0.88769      1.8711      0.6206     0.58502     0.59605     0.60766     0.89955     0.86684     0.53105     0.51198     0.77521     0.55217     0.55425      1.4043      1.3715       1.327     0.61697     0.66276     0.64776     0.62505     0.58153     0.64003     0.98084     0.60615     0.54883     0.56993     0.99702      0.7903      0.7947      1.0493      1.0583      1.0094     0.51985      1.0683     0.78961       2.924     0.60631     0.68013     0.91657     0.60641      1.0332     0.57312       1.101     0.73316     0.54774     0.66515      1.1566     0.80531      2.0019      1.1063     0.72985      0.5281     0.73762     0.50256     0.74057      1.5989     0.82565     0.65355     0.64531     0.77605      1.1929     0.94596];
w1 = [7    9   14   15   16   19   20   21   22   23   25   27   29   32   33   34   36   38   44   45   46   47   54   56   57   58   61   62   63   68   71   76   77   78   82   87   88   90   98  101  102  106  107  108  109  113  116  117  120  121  129  131  137  138  139  140  144  146  152  153  154  156  159  161  164  169  170  171  173  175  176  179  181  185  187  192  193  194  196  197  198  199  201  205  206  209  213  219  220  221  223  225  227  228  231  235  236  237  239  240  241  243  244  247  252  257  259  261  263  264  265  267  269  270  271  273  278  279  283  285  291  292  293  295  297  300];
wr1 = [1.3595      1.3314     0.80203      2.1259     0.56598     0.50147      2.4786     0.80399     0.69566     0.92132     0.68978      1.0946      2.0791     0.81947      1.1602     0.90716      1.2043      1.2589      1.1594      1.2082      1.0601      1.0521      2.4151     0.95815     0.90462      1.5356      1.2679      1.2299      1.6061      2.4559      1.1197      1.7408      1.8135     0.90175     0.79418      2.3771     0.69785     0.87989     0.66817     0.95949       2.492     0.89817     0.61936      1.9564     0.78677     0.51386      1.0818     0.91479      2.6016      1.2776     0.54029     0.50229     0.73084     0.58927      1.1089     0.88955     0.93186     0.70609      1.7954     0.94252     0.68536     0.95769     0.94156     0.73823      1.0195     0.63639      2.5672     0.56562     0.77024     0.91817      1.9981     0.52569     0.51262     0.59738     0.71424     0.57766     0.78353     0.56266     0.78583       1.119     0.78038     0.63207     0.65741     0.51372      1.3079     0.89387     0.69032     0.50989     0.86508     0.72485     0.68407      1.3902     0.76824     0.78933     0.76162     0.88228     0.55414     0.87899     0.74233      1.9794     0.65359     0.91445     0.54204     0.54272     0.74442       1.246     0.57323     0.68486     0.62887      1.1056     0.72668      2.0799     0.79098     0.67381     0.86728     0.61574       1.185      1.1363     0.86585     0.52074     0.54148     0.98642     0.76764     0.75687     0.63184     0.60089];
% 301-500
b2 = [302  304  305  306  311  313  314  315  317  319  325  326  327  329  330  336  338  354  356  357  358  363  364  366  367  368  374  378  381  384  386  392  394  402  406  407  416  420  422  432  435  436  437  438  440  442  446  451  452  455  456  461  462  466  470  471  481  483  486  491  495  496  499];
br2 = [0.5385     0.53121     0.62832       2.522     0.53498     0.64618      1.2148     0.54158     0.84385     0.82566      1.2999     0.85974      1.6552     0.92243     0.67424     0.72011     0.61737     0.72744     0.57746     0.76242     0.69092      2.2793     0.71434     0.65974      1.0178      1.0589     0.53296     0.87504     0.50666      1.4103      1.6082     0.66085     0.50316     0.57193     0.65424     0.60434     0.60609     0.98598       0.512      0.7802      1.0007     0.58572     0.93194     0.72547     0.66465      0.5411      1.9874     0.56746     0.59361     0.54337     0.56684     0.56251     0.93723     0.80437     0.92291     0.52671     0.75377     0.68521     0.96099     0.72352     0.63699     0.53786      2.2134];
w2 = [303  309  316  318  320  322  323  331  333  337  341  343  348  349  352  353  359  360  365  369  371  373  375  376  379  382  383  387  388  389  390  391  395  399  404  405  409  410  411  412  413  415  417  418  419  421  424  425  426  427  433  434  441  443  445  447  448  453  454  457  460  463  464  465  467  474  475  476  478  479  482  484  487  489  490  494  500];
wr2 = [0.68279     0.66007      0.5288     0.68197     0.73137     0.72155     0.51263      1.3098      1.3441     0.55922     0.71649        0.67      1.8149     0.52406     0.80295     0.63984     0.73397     0.68254     0.54092     0.62817      1.1125      1.5534     0.64808       0.652     0.81361     0.59404      1.2859      0.7057      0.6034     0.61429     0.53019     0.87056      1.7577     0.55608     0.68669     0.51381      1.1212     0.81528     0.66857      1.7435     0.57519     0.51298     0.68541     0.81432      1.7516     0.61587     0.69811      1.1045     0.83606     0.97666     0.52641      1.0846      1.1871      0.5109     0.80132      1.0858     0.50915     0.88322     0.90919     0.60901      2.0897     0.80535     0.82033      1.1264      0.9656     0.60205      1.0667     0.58178     0.94684     0.70945      2.4376     0.68863     0.64452     0.66127      1.0438     0.65259     0.77462];
% 501-800
b3 = [501  502  504  511  513  516  519  520  521  523  528  533  537  539  542  543  544  546  547  557  561  563  565  567  575  589  593  596  597  598  599  603  604  611  617  618  624  625  627  630  631  634  640  641  651  653  655  656  658  659  660  663  665  668  670  672  674  676  677  678  681  688  697  701  705  709  710  713  721  722  729  735  736  737  743  745  746  748  749  752  754  755  756  759  761  762  763  765  766  772  774  782  783  785  793  798  800];
br3 = [0.60037     0.99601     0.51924           1     0.66118     0.89681     0.69571     0.63411      1.0153     0.87463     0.69804      1.2679      0.6153      1.7447     0.70624     0.50087     0.51507     0.80234     0.67368      0.7366     0.71589     0.84422     0.73389     0.56659     0.64884      2.1587       1.767      1.2881      1.7003     0.77163     0.51465      1.4075     0.59422     0.74302     0.56213     0.84924     0.65555     0.51994     0.57098     0.57195     0.57172     0.65763      1.0678      1.5033     0.85197      1.2009     0.67924     0.61557     0.68393      0.5568     0.57289     0.95721     0.65223     0.58151     0.50134     0.60214      1.3673     0.65197     0.63688     0.65049     0.53424     0.92173     0.66553      1.1198     0.64001     0.90309     0.98012      0.5985      0.6107     0.50247      1.3642       1.273     0.70414     0.72477     0.57787     0.66498     0.94006     0.56184     0.73918     0.57168      1.1249     0.52506     0.79574      1.0071      1.2028     0.62853     0.85303      1.8423     0.55828      0.9875     0.61007     0.69632     0.56031      1.0076     0.61531     0.71925     0.90402];
w3 = [503  505  506  507  512  514  517  518  524  525  526  527  529  530  531  532  534  535  536  538  540  541  545  549  550  551  554  555  556  559  560  562  568  569  573  574  576  579  580  583  587  590  591  592  595  601  605  607  609  613  619  620  623  626  629  632  635  636  638  643  645  646  650  652  657  661  662  664  667  669  671  673  675  679  682  684  686  689  691  693  695  696  699  700  702  703  708  714  715  716  718  719  720  723  726  727  730  733  738  739  742  750  757  758  764  767  768  770  771  773  776  777  781  784  786  788  789  790  792  795  796];
wr3 = [0.55549     0.50603     0.50718     0.75038     0.52356      1.3401     0.61413      0.7472     0.76994     0.50622      1.3863      1.1693     0.65238     0.75464     0.85558      0.7276      1.0445      1.1492     0.82968     0.50393      0.5594     0.51502     0.62215     0.50309      1.4519     0.99989      1.0389     0.54224      1.1978     0.73501     0.59219      0.8565      1.1997     0.59311     0.79077     0.92184     0.56754       1.493     0.83104      1.0492     0.73913     0.60104     0.52947     0.74426     0.50345      0.7817     0.93154     0.52407     0.61203     0.98695     0.77629     0.66025     0.51524     0.52055     0.81778     0.51116     0.53506     0.67327     0.64502      1.1245      1.4973     0.58097       1.271     0.67845     0.86713     0.56756      1.0502     0.76743      1.2172      1.5697     0.83075     0.68118     0.53087     0.66665     0.93082     0.52508     0.54962     0.77006     0.70364     0.52192     0.53625     0.62999      0.5417     0.52264     0.61718     0.62012     0.82812     0.73739     0.79207      1.0369     0.72045     0.95941     0.82428     0.92201     0.58694     0.77786      0.5186     0.69016     0.74928     0.58283     0.94345      1.1369     0.51884      0.7035     0.82144     0.79685      1.2664     0.63704     0.86827       1.461     0.72399     0.77697     0.60878     0.63515     0.72637     0.54859     0.60146     0.83476     0.91419      1.2626       1.106];
% 801-1000
b4 = [803  805  806  810  813  815  816  817  818  821  823  828  836  838  842  843  844  847  849  855  856  858  860  862  864  866  870  871  876  882  886  889  891  892  897  899  900  901  902  904  911  912  918  920  923  924  927  928  935  942  945  951  956  960  962  965  969  971  974  978  981  983  988  989  990  992  993  997  998];
br4 = [0.81247     0.54384     0.65459     0.76008     0.50243     0.77143       1.035     0.52521     0.82958     0.89771      0.5126     0.73887      1.1782     0.61023     0.62641     0.99525     0.84384     0.54638     0.55894     0.52912     0.85891      1.6826     0.59728     0.50227      1.3553     0.76335     0.57864     0.68416      0.7191     0.62882     0.56181     0.92122      0.9127     0.63307     0.52619      0.5062     0.62993     0.63304      1.1808      1.0165     0.81602     0.54202     0.50302     0.54686      1.0147     0.98066     0.53941     0.83239      0.5033     0.56318      1.1539      1.2448     0.59539      1.1761       1.181     0.50433     0.58211     0.54071     0.61023     0.60735     0.65771     0.71002     0.67152     0.50282        1.24      1.6036     0.60004     0.71336     0.53832];
w4 = [801   802   804   808   809   812   814   820   825   826   827   830   831   834   835   837   840   841   846   853   854   867   868   872   873   875   878   879   881   885   887   888   890   893   895   898   903   905   906   909   910   914   917   926   929   932   933   938   940   941   943   944   950   952   955   957   959   964   966   967   968   970   973   975   977   979   985   986   987   991   996   999  1000];
wr4 = [0.63647      1.2031     0.91012       1.175      1.0165      0.9979     0.76089     0.60582     0.98707      1.5545     0.61657     0.60154     0.50354     0.50214     0.97677     0.73548     0.67008     0.80595     0.78649      1.3597     0.94507     0.95674      0.5371     0.87899     0.80903     0.65575     0.74164      1.1873     0.52343     0.56213     0.54001      1.3984     0.72951      1.0073      1.0946     0.72516     0.76478     0.73438     0.71932     0.59363     0.88687     0.76694     0.57227     0.71406     0.54225     0.54717     0.53287     0.95237     0.67417      1.5217     0.70841     0.68514     0.55523     0.65897     0.84189     0.68535     0.50465     0.78494     0.90806      1.1135     0.62707     0.71183     0.92839     0.96439     0.73588     0.87126      1.5004     0.60304      1.0676     0.83245     0.54351     0.72594     0.73977];
% 1001-1400
b5 = [1001  1005  1006  1010  1011  1014  1016  1018  1019  1022  1025  1026  1030  1032  1034  1036  1037  1039  1049  1050  1051  1056  1063  1064  1066  1067  1069  1070  1074  1076  1082  1087  1091  1094  1096  1098  1099  1102  1110  1114  1116  1117  1118  1119  1127  1129  1133  1135  1137  1139  1140  1149  1150  1152  1157  1158  1168  1171  1172  1174  1177  1178  1183  1184  1189  1190  1192  1193  1194  1197  1198  1200  1203  1206  1208  1209  1212  1216  1217  1220  1223  1226  1229  1231  1233  1234  1237  1240  1243  1244  1247  1250  1251  1258  1259  1260  1265  1268  1271  1272  1273  1278  1280  1283  1287  1292  1298  1299  1302  1304  1305  1306  1308  1310  1311  1318  1320  1321  1327  1331  1333  1336  1337  1342  1344  1346  1350  1353  1355  1358  1367  1368  1369  1370  1372  1374  1375  1376  1378  1386  1387  1391  1395  1399];
br5 = [0.53751     0.59069     0.55257     0.97886      1.2017     0.59447     0.56853      1.3413     0.89156     0.62748      1.0229      0.9467     0.76107     0.54251     0.57756      1.1938     0.56783     0.55007     0.55965     0.50785     0.59405      0.6239     0.51974     0.98477     0.96793     0.67573     0.82636     0.97534     0.72492     0.66954     0.52957     0.85066     0.74754     0.53879     0.98732      1.5839     0.50212     0.50328     0.74901     0.88264     0.71375     0.64039     0.55474     0.50354      1.2102     0.64907     0.97631     0.61678     0.82063      1.0159      0.5841     0.55428     0.64546      1.1602     0.51338      1.3371     0.54787     0.88287      0.5646     0.62077     0.70139      2.2197     0.92384     0.51913     0.60803      1.1391     0.52064      1.2145     0.52587     0.50306      1.0219     0.52242     0.53264     0.65794     0.61206      0.8874     0.53585     0.63989     0.71177     0.67454     0.70327     0.73232     0.81101     0.92408     0.65627     0.54479      0.6327     0.98378     0.59585     0.57441     0.51422       1.047     0.55993     0.92911     0.59207     0.56175     0.52473       0.556     0.59565     0.91958     0.74002     0.91094     0.63453     0.73668      0.6298      1.1626     0.61456     0.57218     0.67082      0.6238      0.6174     0.71431     0.74319       0.689     0.53066     0.59482     0.63885     0.61549     0.66796      0.5157     0.93843     0.69974     0.53052      1.0331      0.5187     0.72964     0.77874     0.57229     0.79755     0.50813     0.50007      1.1865     0.58313     0.90712     0.52611     0.52244     0.66762     0.63731     0.73099     0.56367     0.64924     0.51377     0.65157     0.93275];
w5 = [1002  1004  1008  1009  1012  1020  1021  1023  1024  1029  1031  1033  1035  1043  1046  1052  1053  1054  1055  1058  1059  1060  1061  1062  1071  1073  1077  1079  1080  1083  1084  1085  1086  1088  1095  1097  1105  1106  1107  1112  1115  1120  1121  1122  1124  1126  1131  1132  1134  1138  1141  1142  1143  1144  1145  1146  1147  1151  1154  1156  1160  1161  1163  1166  1167  1173  1176  1179  1180  1181  1191  1195  1199  1202  1205  1214  1218  1222  1224  1225  1230  1232  1235  1236  1239  1242  1245  1246  1252  1253  1254  1255  1256  1257  1261  1263  1264  1266  1267  1269  1270  1274  1275  1277  1279  1281  1282  1288  1290  1295  1296  1300  1303  1307  1312  1314  1315  1326  1328  1330  1332  1334  1338  1339  1341  1343  1347  1348  1351  1356  1357  1359  1360  1361  1363  1365  1371  1377  1380  1382  1383  1385  1392  1394  1396  1398  1400];
wr5 = [0.99812     0.90477     0.59843     0.53579     0.50525       1.173     0.67816     0.51035     0.88718     0.75406     0.53442      1.0141       1.074     0.70523      0.6161      0.7361     0.67265     0.62548     0.54736     0.54215     0.64029     0.98324     0.65124     0.86772     0.57195     0.61981      0.9761     0.81042     0.75756     0.65462     0.72101      1.2665     0.78788     0.66225     0.53042     0.79441      0.6793     0.53369     0.76143     0.68488     0.87381     0.54863      1.1094     0.54331     0.88826     0.66782        1.16     0.65215     0.94229     0.51411      0.6169     0.57093     0.74064     0.74207     0.78944     0.52044     0.76763     0.68878     0.63955      1.0876     0.81887     0.74962     0.57354      1.1092     0.84127     0.53644     0.78328     0.79185     0.60123     0.62813     0.73602     0.78379     0.89751      0.9893     0.75491     0.65154     0.53563      1.1147     0.80028     0.74624     0.60328     0.79471     0.56879     0.94272     0.78306     0.73782     0.72208     0.83209     0.67044     0.66256     0.63287      0.6836     0.74085     0.53232      0.6082      1.0999     0.81705     0.65938     0.88252     0.84664     0.55223     0.63349     0.53622      1.0533     0.84948     0.58976     0.69493     0.62691     0.64201      1.1276     0.76966     0.54017     0.76305     0.78494      0.5117      1.2741     0.57021     0.54764     0.98326     0.78664     0.50858     0.87484     0.99396      1.3021     0.88659     0.50954     0.52892     0.62516     0.63524     0.85563     0.51288      1.0448      1.1426     0.65168     0.64896     0.59921     0.52636     0.59058     0.87277     0.74737     0.74454     0.72376     0.72772      0.5987     0.59691     0.59349     0.86883];
% 1401-1500
b6 = [1402  1405  1410  1411  1413  1414  1416  1417  1419  1421  1424  1427  1430  1442  1448  1450  1451  1453  1455  1456  1459  1462  1463  1466  1470  1475  1476  1477  1479  1481  1482  1487  1489  1490  1493  1494  1497  1499  1500];
br6 = [0.85054     0.66807     0.62522     0.50259      1.0389     0.86589      1.0996     0.82685     0.62777      0.7089     0.57973     0.75363     0.88502     0.53537      0.6397     0.61016     0.50197     0.62613     0.55523     0.61192     0.69873     0.79765     0.56996     0.64381      0.7947      1.1134     0.54424     0.54232     0.59155     0.54672     0.52006     0.64121     0.60713      1.1158     0.59022     0.61082      0.5128     0.57126     0.93825];
w6 = [1403  1404  1408  1415  1420  1425  1426  1433  1434  1435  1436  1440  1441  1444  1447  1452  1454  1461  1464  1465  1468  1471  1472  1473  1474  1478  1480  1483  1484  1485  1486  1491  1492  1496  1498];
wr6 = [0.92152      0.6092      0.7604      0.6068     0.66283     0.76481      1.0068     0.54691     0.75875     0.64674     0.71814     0.55901     0.82556     0.66914     0.57685     0.66853     0.78144     0.61655     0.51757     0.62052     0.68118      0.5531     0.67855     0.69136     0.65869     0.99127     0.50518     0.50703     0.94774     0.67049     0.50268     0.78831     0.98446     0.62945     0.97058];
% 1501-2037
b7 = [1501  1505  1508  1510  1511  1512  1514  1516  1517  1518  1519  1525  1527  1528  1532  1535  1536  1540  1542  1544  1546  1547  1548  1549  1560  1561  1566  1567  1570  1571  1572  1575  1577  1578  1580  1581  1584  1585  1588  1589  1595  1598  1601  1602  1603  1610  1612  1614  1618  1619  1623  1628  1635  1636  1637  1642  1648  1651  1654  1656  1657  1658  1660  1661  1663  1665  1671  1675  1678  1680  1681  1682  1683  1688  1690  1694  1695  1696  1697  1698  1702  1704  1705  1707  1708  1711  1712  1713  1714  1715  1718  1719  1727  1730  1737  1739  1741  1746  1757  1758  1761  1765  1768  1770  1772  1774  1775  1776  1777  1778  1779  1780  1781  1783  1784  1786  1793  1797  1806  1808  1809  1810  1811  1816  1819  1821  1822  1825  1827  1830  1831  1833  1834  1835  1839  1842  1845  1848  1858  1859  1864  1865  1867  1870  1873  1875  1876  1877  1878  1880  1881  1882  1888  1889  1891  1893  1896  1898  1899  1900  1901  1907  1910  1912  1914  1915  1917  1918  1920  1921  1923  1925  1926  1929  1930  1931  1932  1933  1934  1939  1944  1947  1952  1954  1961  1964  1966  1968  1969  1973  1977  1982  1987  1988  1991  1995  1996  1997  2000  2002  2004  2005  2006  2007  2008  2013  2014  2020  2021  2022  2025  2026  2029  2030  2034  2035  2036];
br7 = [0.55858     0.65993     0.52765     0.67249      0.7981     0.98032     0.77414     0.64509     0.63096     0.61172      0.8071     0.54857     0.69023     0.80383     0.77926      1.2963     0.77062     0.60683     0.50143     0.87365     0.58198     0.56773     0.53845     0.56184     0.51712      1.3013     0.51789      1.2159     0.70732     0.59051      0.5981      0.5564     0.88601     0.65937     0.65413     0.50843      1.1881     0.81633     0.52994     0.96757     0.65639     0.79354     0.67711      0.7021     0.73627     0.55009      1.1837     0.86909      0.5017       1.105     0.61132     0.52393     0.55864     0.77102     0.59752     0.64136     0.63158     0.81882      1.2365     0.51354      0.5857     0.67607     0.66227     0.70507     0.85325     0.67177     0.50296     0.52852     0.52215     0.76336     0.57097     0.51395     0.81785     0.64172     0.51791      1.2625     0.71988     0.52756     0.90849     0.70545      0.6801     0.57373     0.57942      0.6723     0.68564     0.91889     0.76496     0.80253     0.67081     0.57378     0.62026      1.3023     0.52043      0.6783     0.53007     0.51202     0.68658     0.61904     0.55383     0.81544     0.57783     0.65031     0.57833     0.73755     0.56626     0.93253      0.5578      1.4194     0.54756     0.55861     0.52962     0.54268     0.56216      0.5086     0.73936     0.90591     0.50168     0.51033     0.54608     0.59034     0.56695      0.6411     0.81613      0.5974     0.50261      0.5111     0.58919     0.84317     0.67671     0.72303       0.582     0.67899     0.74547     0.51773     0.68391     0.51465     0.60152      1.2876      1.0882     0.66358     0.64813     0.51718      1.3725     0.62059      1.1558     0.64481     0.71958     0.60032     0.57232     0.52796     0.58496     0.54043     0.67751     0.83335     0.51737     0.61372     0.51994     0.71284     0.50793     0.63686     0.57154     0.52203     0.70062     0.81205     0.57853     0.55257     0.58497     0.89375      0.5073     0.65343     0.75546     0.63838     0.89884     0.50825     0.70463     0.61411     0.53448     0.70035     0.51769      0.6376     0.50456     0.75984     0.60559     0.74217     0.50796     0.60851     0.89355     0.57766     0.54438     0.63655     0.50964     0.70623     0.53984     0.63668     0.96214     0.51018     0.63856     0.51143      1.6563     0.97155     0.52522     0.52797     0.75546     0.68232      1.0074     0.75473      0.6737     0.52987     0.92839     0.57489      0.7219     0.59183     0.53834     0.50094     0.57751     0.56372     0.55794];
w7 = [1504  1507  1513  1515  1520  1524  1526  1530  1531  1534  1538  1539  1541  1543  1550  1552  1555  1557  1558  1563  1568  1574  1582  1587  1590  1593  1594  1596  1597  1600  1604  1605  1608  1609  1611  1613  1615  1617  1620  1621  1624  1627  1630  1631  1632  1640  1643  1644  1652  1653  1655  1662  1664  1668  1673  1674  1677  1679  1686  1687  1689  1691  1692  1701  1706  1709  1710  1716  1717  1720  1722  1724  1732  1733  1736  1740  1742  1743  1748  1751  1752  1753  1754  1755  1762  1763  1764  1766  1773  1782  1787  1789  1790  1791  1795  1796  1798  1800  1804  1805  1807  1814  1820  1824  1826  1828  1829  1836  1838  1841  1844  1846  1847  1850  1852  1853  1856  1857  1860  1861  1862  1868  1869  1872  1874  1883  1884  1885  1886  1887  1892  1894  1895  1902  1908  1909  1928  1935  1937  1942  1943  1945  1946  1949  1950  1951  1953  1955  1956  1957  1959  1960  1971  1972  1974  1975  1978  1980  1981  1983  1984  1986  1992  1994  1999  2001  2003  2009  2010  2011  2016  2027  2031  2033];
wr7 = [0.5784     0.75769      0.5755     0.65586     0.99268     0.63132     0.52096     0.72635     0.52908     0.63466     0.71101     0.76204     0.78642     0.56072      1.1427     0.50034     0.50672     0.55564     0.71852      1.2125     0.51142     0.74518     0.76343     0.58953     0.63212     0.51797     0.68867     0.57014     0.59022     0.50223     0.84345      1.2271     0.95282     0.50761     0.60618     0.75727     0.56708     0.84705     0.72988      0.5699     0.60997     0.52099     0.72173     0.75985     0.69351     0.71021     0.82224     0.62888      1.8572     0.62804      1.5613     0.50178     0.80531     0.54909       0.578        0.91     0.84296     0.55513     0.53399     0.63454     0.76812     0.67387     0.72217     0.63666     0.51575     0.73203     0.53043     0.59542     0.60147     0.59589     0.59527     0.50978     0.63902     0.61602      0.6925     0.79492     0.53269     0.99148     0.65545     0.68116     0.70611      1.3897     0.51543     0.72472     0.93898     0.57711     0.66437     0.77261     0.52881     0.74282      1.3426     0.52758     0.80975     0.55458     0.50893      0.6091     0.69021      1.2296     0.78985      1.1958     0.57573      1.0012     0.51653     0.72136     0.84832     0.50415     0.54308     0.58707       1.232      1.3389     0.64275     0.52078     0.54132     0.51397     0.59313     0.63168     0.86173     0.59492     0.54492     0.53086     0.89018     0.93929     0.56944     0.52724     0.75112     0.75462     0.50533     0.50566     0.57343      1.0336     0.78482     0.54241     0.89657     0.73055       0.562      1.2877     0.52466     0.60838     0.62053     0.50347     0.87367     0.62639     0.53693     0.62938     0.87849     0.65372     0.75245      0.5139     0.93296     0.55562     0.77884     0.50575     0.53264     0.61256      1.0822     0.51978     0.62415     0.83224     0.55582     0.50512       1.315     0.57886     0.74403     0.53683     0.59221     0.57117     0.57054     0.91049     0.56019      1.0164     0.71453     0.51559     0.59311     0.80632];
% 2038-2400
b8 = [2308  2309  2311  2312  2313  2314  2315  2319  2322  2323  2325  2326  2327  2328  2331  2332  2337  2339  2343  2344  2345  2346  2349  2351  2352  2354  2358  2367  2368  2379  2384  2388  2390  2397];
br8 = [0.71251     0.83868     0.64266     0.53167      1.1064     0.70082     0.73434     0.51895     0.51376     0.67926     0.50153     0.77571     0.56013     0.72715     0.75729     0.50645     0.93682     0.58605     0.61915     0.77247     0.57528     0.54852      0.6183     0.67238     0.67459       0.551     0.63615     0.52342      1.2439     0.52996     0.59348     0.61043     0.51684     0.52378];
w8 = [2310  2318  2321  2324  2330  2334  2335  2336  2341  2342  2355  2356  2357  2361  2362  2363  2372  2374  2375  2376  2377  2378  2381  2386  2387  2391  2392  2394  2395  2396  2398  2400];
wr8 = [0.83153     0.58503      0.6996      0.5115     0.52438     0.50992     0.51949     0.54181     0.59629      0.5019     0.58779     0.66109     0.94922     0.54654     0.71212     0.81123     0.64447      0.5258     0.79443      1.1607     0.54206     0.59566     0.54144     0.67959     0.74176     0.52239     0.61808     0.50199     0.54607     0.50897     0.75911     0.95596];
% 2401-3000
b9 = [2403  2405  2407  2408  2409  2411  2413  2414  2419  2423  2425  2426  2427  2428  2429  2430  2432  2434  2435  2437  2439  2444  2447  2450  2451  2458  2459  2461  2465  2467  2468  2472  2474  2481  2483  2489  2491  2494  2496  2497  2499  2500  2501  2505  2508  2514  2517  2523  2524  2525  2527  2529  2532  2534  2536  2541  2545  2550  2552  2556  2560  2561  2565  2566  2567  2570  2572  2573  2580  2583  2585  2587  2590  2592  2594  2596  2597  2601  2603  2604  2607  2608  2612  2614  2615  2617  2619  2620  2622  2625  2626  2627  2629  2630  2638  2640  2645  2647  2648  2652  2655  2656  2657  2658  2661  2663  2664  2666  2668  2669  2670  2671  2676  2677  2678  2681  2685  2687  2689  2692  2693  2694  2698  2702  2705  2706  2707  2708  2709  2710  2711  2713  2715  2717  2718  2719  2724  2726  2731  2732  2735  2737  2738  2739  2740  2744  2745  2746  2747  2748  2751  2754  2757  2758  2760  2761  2763  2764  2767  2769  2773  2776  2779  2784  2785  2787  2788  2789  2790  2792  2795  2796  2798  2803  2804  2812  2813  2814  2815  2819  2820  2822  2823  2825  2830  2831  2832  2833  2834  2835  2838  2839  2841  2842  2845  2846  2848  2857  2859  2860  2863  2866  2867  2869  2870  2871  2876  2878  2882  2884  2885  2888  2889  2891  2895  2896  2897  2899  2904  2908  2909  2910  2913  2914  2918  2924  2927  2928  2929  2932  2933  2934  2935  2937  2941  2942  2943  2944  2951  2952  2953  2954  2959  2968  2974  2975  2978  2979  2981  2987  2989  2990  2992  2993  2998  2999  3000];
br9 = [0.54206     0.60378     0.74411     0.51338     0.50051     0.53374     0.71209     0.62852     0.95872     0.56669     0.55942      1.3237     0.51741     0.56819     0.50659     0.56016     0.74463      0.8742     0.64591     0.55203     0.93026     0.59119     0.73143      1.2177     0.67614     0.57374     0.53465     0.68685     0.52137     0.85422     0.52325     0.51009     0.59541     0.61073     0.54184      0.8206     0.60852      0.5488     0.50984     0.76309     0.71391     0.55149     0.78499     0.55272     0.57598     0.54074     0.56295     0.71833     0.56144     0.53893     0.58637     0.53408     0.51679     0.55503     0.52489     0.52418     0.65664      0.6564     0.54435     0.90116     0.84934     0.56875     0.58673     0.83951     0.59632     0.52114     0.55196       0.502     0.55693     0.52717     0.55694     0.58261     0.57535      0.6515     0.61332     0.59306     0.79464     0.77079      0.5101     0.71935      0.5352     0.97439     0.56983     0.54074      1.0032     0.75058      1.2884     0.76024     0.53832     0.52327     0.67234       0.591     0.58257     0.67442     0.54898     0.64637      1.0113     0.51819     0.67904     0.61115     0.88479     0.61514     0.59656      1.0763     0.55003     0.70901     0.51547     0.60827       0.684     0.80351     0.51165     0.60414     0.54758     0.66824     0.56959     0.70684     0.96594     0.50071      1.1448     0.60197     0.70158     0.68486     0.87853     0.52546     0.50826     0.67231     0.54869      1.0113     0.56491      0.6244     0.68659     0.54042     0.71389     0.59393      0.6756     0.51365     0.59193     0.58521     0.80355     0.56104     0.53763     0.70288     0.56458     0.59367     0.62815     0.70134     0.51452     0.59141     0.70009     0.80518     0.53356      1.4476     0.51437     0.61179     0.54848     0.52308      1.2728      0.5728      1.0589     0.69553      0.5521     0.66634      0.9308      0.6434     0.77905     0.50552     0.62846     0.62542     0.58731     0.83458     0.52844      1.0317     0.50877     0.80388     0.96525     0.55295     0.98619     0.52181      0.5798     0.51279      0.5411     0.51164     0.69428     0.64368      1.1144     0.59138     0.60298     0.52331     0.79254     0.52098     0.53186     0.55466     0.54012     0.53472     0.52681     0.64031      0.5092     0.60292     0.56009     0.77002     0.56453      1.2883     0.52632     0.50231     0.53823     0.57126     0.53819     0.63319     0.83058     0.71804     0.51204      1.0584     0.81022      1.1957     0.61113     0.88038       1.068     0.69697     0.51164     0.52212     0.62231     0.77106     0.86063     0.58852      0.6163     0.62317     0.51257      0.9838     0.77673     0.71355     0.56161     0.57151     0.51243     0.53163     0.56495     0.68545     0.55471     0.69277     0.55551     0.71819     0.63699     0.57446     0.53722      0.5235     0.53391     0.66429     0.53356     0.52028     0.67336     0.52459     0.69748     0.80956     0.58311     0.60563     0.62033     0.72723     0.60232];
w9 = [2401  2402  2406  2410  2412  2415  2418  2420  2421  2424  2440  2441  2442  2443  2445  2452  2453  2460  2462  2466  2469  2471  2475  2476  2479  2480  2484  2486  2487  2488  2490  2502  2503  2504  2506  2509  2512  2513  2516  2518  2526  2528  2533  2538  2539  2540  2542  2543  2544  2546  2548  2551  2555  2557  2562  2563  2568  2569  2578  2579  2581  2582  2584  2588  2589  2593  2595  2598  2605  2609  2613  2616  2624  2632  2633  2636  2639  2641  2643  2646  2649  2650  2653  2654  2660  2662  2679  2682  2684  2686  2688  2690  2695  2696  2697  2699  2701  2703  2704  2712  2721  2729  2733  2734  2736  2742  2749  2750  2753  2755  2756  2762  2766  2770  2771  2774  2777  2778  2783  2793  2794  2801  2802  2805  2809  2810  2816  2817  2824  2826  2836  2840  2843  2844  2849  2855  2864  2868  2877  2883  2886  2887  2893  2894  2900  2901  2902  2906  2912  2919  2922  2923  2930  2931  2938  2946  2948  2949  2955  2958  2961  2963  2965  2966  2970  2971  2972  2973  2976  2984  2985  2986  2988  2991  2994  2995  2996];
wr9 = [0.50991     0.53601     0.53112     0.51207     0.62518     0.50739     0.72185       0.556     0.57449     0.91689      0.6672     0.68178     0.50643     0.64868     0.63345     0.68982     0.63824     0.58773     0.84034     0.63251     0.55992        1.04     0.56231     0.51556      0.5859     0.51446      0.7503     0.63033      1.1515     0.60523     0.51447      0.6718     0.60692     0.71507     0.75905     0.70743      1.4866     0.72211     0.59836     0.65011     0.82182     0.51701      0.5408     0.52795     0.51814     0.59621     0.55676     0.50454     0.53101     0.58297     0.53262     0.80027     0.55113     0.53608     0.91965     0.64523     0.55432     0.53424     0.80785     0.62612     0.56847      1.3892     0.57576      0.5164     0.90636     0.98698      0.5604     0.57346     0.88165     0.65996     0.88204     0.50001     0.72052     0.84871     0.61214     0.63083      1.0068     0.54766      1.1242        0.58     0.54813     0.53177     0.70482     0.64537     0.61879     0.69895     0.54071     0.74223     0.65243     0.53162     0.61971     0.61602     0.68166      1.0883     0.67708     0.50891     0.61026     0.67452     0.93331     0.54105     0.58739     0.60517     0.71264     0.63402     0.63298     0.66163     0.50184     0.63059     0.58755     0.57887     0.61001     0.69455     0.68434     0.51093     0.53169     0.66071     0.53894     0.52622     0.53226     0.61633     0.70291     0.54267     0.78533     0.54255     0.85469     0.71672     0.58918     0.50531     0.55339     0.65158     0.61016     0.60529      0.5662     0.68211      0.5708     0.60934     0.71642     0.56283      0.6807     0.55835      1.2288     0.61074     0.64783     0.60932     0.50703     0.97055     0.50025     0.66365     0.53702     0.54512      1.0262     0.94239     0.55403     0.54139     0.55798     0.55297     0.61394     0.53507     0.61322     0.63816     0.80793     0.54362     0.53432       0.516     0.51405     0.59987     0.77548     0.72073     0.51004      0.9391     0.82059     0.53643     0.60489     0.58904      0.5178     0.52373     0.56317];
% 3001-3200
b10 = [3004  3005  3006  3009  3016  3017  3019  3022  3023  3026  3031  3032  3033  3036  3037  3039  3040  3042  3045  3048  3049  3051  3054  3057  3062  3064  3069  3074  3077  3079  3080  3082  3083  3087  3088  3090  3092  3094  3095  3100  3103  3108  3111  3112  3113  3115  3118  3119  3126  3133  3134  3136  3139  3146  3147  3148  3150  3151  3153  3156  3157  3162  3164  3168  3169  3171  3174  3183  3184  3192  3193  3198];
br10 = [0.58151     0.55589     0.81658     0.68734     0.50318     0.54629       1.441     0.53526     0.53157     0.56191     0.60347      0.5413     0.71825     0.59045     0.57863     0.65615      1.6107     0.74554     0.54437      0.9491     0.54068      0.7245     0.56476     0.55773     0.79439     0.72395     0.56207     0.56677     0.82054     0.59039     0.52009      1.1259     0.59539     0.59335     0.69772     0.59317      0.5121     0.71996      1.2301     0.83071     0.57433     0.51245     0.90717      1.0353     0.67451     0.52544     0.51386     0.69328     0.61858     0.79603     0.51042     0.74765     0.93085     0.54824     0.50466     0.52586     0.51416     0.51358     0.63673     0.60216     0.70033     0.62571     0.59595     0.59763     0.57016     0.50827     0.62162     0.78809     0.53182     0.53128     0.92728     0.57941];
w10 = [3001  3010  3011  3015  3018  3021  3027  3028  3035  3041  3047  3050  3052  3053  3055  3056  3059  3070  3071  3072  3073  3075  3076  3085  3093  3096  3097  3102  3104  3106  3107  3109  3110  3114  3116  3121  3124  3128  3130  3131  3135  3138  3140  3143  3144  3145  3149  3152  3154  3159  3161  3166  3170  3172  3175  3178  3179  3181  3182  3185  3194];
wr10 = [0.52731     0.78741     0.53883     0.62151     0.71748     0.50052     0.53672     0.53125      0.5865      0.7328     0.73596     0.53026     0.51804     0.64795     0.64505     0.71523     0.50743     0.72186     0.55707     0.59367     0.72966     0.53405     0.51573     0.61736      0.5231     0.57883     0.51862     0.51632      0.6715      0.5839     0.68153     0.60897     0.56762     0.63028     0.66756     0.52083       0.632     0.50678     0.50324      0.6731     0.69651     0.64551     0.59802     0.57384     0.61433     0.53635     0.52765      0.5884     0.51395     0.54562     0.58516      0.5404     0.83412     0.50358     0.56134     0.61833     0.53886     0.61779     0.55012     0.81973     0.99655];
% 3201-3405
b11 = [3201  3210  3213  3215  3220  3224  3225  3226  3227  3228  3234  3235  3236  3238  3239  3242  3244  3246  3249  3252  3253  3256  3260  3262  3263  3264  3265  3266  3267  3268  3270  3273  3275  3276  3281  3283  3284  3290  3299  3304  3306  3307  3309  3313  3315  3317  3318  3319  3321  3327  3330  3334  3335  3336  3337  3341  3344  3346  3351  3354  3355  3356  3357  3358  3359  3360  3363  3366  3368  3369  3372  3373  3380  3382  3383  3385  3392  3393  3395  3396  3397  3402  3404];
br11 = [0.5543     0.64995     0.61316     0.51082     0.59222      0.7639     0.69973     0.50604     0.53529     0.61615      0.5875     0.83924      1.1685     0.64029     0.61134     0.50684     0.52446      0.5291     0.62643     0.66519     0.68452     0.85739     0.56533     0.86731     0.79346     0.64348     0.61743     0.51682     0.86512     0.53161     0.58995     0.87643     0.59229     0.59409     0.51767     0.69188     0.55724     0.66995     0.55253     0.51783     0.87066      0.5583     0.60904      0.5387     0.67025     0.51552     0.55044     0.61856      0.9264     0.70868      0.5927     0.55217     0.53928     0.55409     0.63411     0.66737     0.53438     0.60844     0.76709     0.54229     0.52987     0.60534     0.59216     0.60187      1.0804     0.50594     0.69552     0.50648     0.58034     0.59185     0.97289      0.6455     0.65363     0.53514     0.57704     0.60278     0.53084     0.64906     0.61412     0.56588     0.54844     0.54017     0.55202];
w11 = [3204  3218  3219  3222  3230  3231  3232  3243  3247  3248  3250  3254  3255  3269  3272  3278  3285  3286  3288  3291  3292  3293  3296  3298  3301  3310  3312  3316  3322  3323  3325  3326  3333  3339  3347  3349  3353  3361  3364  3365  3371  3374  3377  3378  3381  3386  3388  3389  3390  3394  3398  3399  3400  3401  3403];
wr11 = [0.56917     0.57504     0.58708      0.5241     0.52495        0.51     0.69286     0.72885     0.55781      1.4948     0.50006     0.60532     0.58556     0.53527     0.52919     0.55793     0.56324     0.54978     0.63503     0.69932     0.55414     0.65884     0.80711     0.53325     0.54239     0.74352     0.54893     0.56829     0.53998     0.53666     0.57333     0.64689     0.69702     0.51923     0.92479     0.52433     0.50191     0.61511     0.53626     0.64502     0.63318      0.8108     0.54618     0.53018     0.57502      0.5205     0.52997      0.8412     0.95557     0.50468     0.60936     0.53391     0.53857     0.73596     0.80912];

% final combination
bROI = [b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11];
wROI = [w1 w2 w3 w4 w5 w6 w7 w8 w9 w10 w11];
bResp = [br1 br2 br3 br4 br5 br6 br7 br8 br9 br10 br11];
wResp = [wr1 wr2 wr3 wr4 wr5 wr6 wr7 wr8 wr9 wr10 wr11];

%% create data on dual-responsive ROIs (recorded earlier)
% NOTE: the white dual response lists (first set) are ROIs originally
% labeled as black responses (i.e. higher response to black) but have a
% white response that is also above the threshold. black dual response list
% is the inverse

% 4 - 1477
wd1 = [28    30    37    55    81    84    94   103   112   122   128   132   141   143   149   150   155   158   163   183   190   203   207   208   211   212   216   217   218   233   245   248   254   256   262   268   272   275   280   284   290   294   296   298   304   305   306   313   314   317   325   326   327   330   363   364   367   368   374   378   384   386   406   420   432   435   436   437   438   446   451   481   486   495   499   516   520   521   528   533   537   542   546   547   557   561   563   575   589   593   596   597   603   611   617   618   624   640   641   651   653   655   658   660   663   677   678   688   697   701   709   710   721   729   735   736   737   745   754   772   774   783   785   798   800   803   806   816   818   821   828   838   843   844   864   866   870   882   889   892   897   901   902   904   923   924   927   928   945   951   956   960   978   981   983   988   990   992   993   997   998  1010  1011  1014  1018  1019  1022  1025  1026  1064  1066  1067  1069  1070  1074  1076  1082  1087  1091  1096  1098  1110  1114  1133  1135  1137  1139  1149  1152  1158  1178  1183  1190  1192  1193  1198  1203  1209  1216  1217  1220  1223  1226  1229  1233  1237  1240  1250  1258  1259  1271  1272  1273  1298  1304  1305  1308  1310  1318  1320  1321  1333  1336  1346  1350  1368  1370  1375  1395  1402  1413  1414  1416  1417  1419  1421  1427  1442  1448  1453  1456  1459  1462];
wdr1 = [0.85585     0.51421     0.85986     0.80615     0.54816      0.7371     0.98292     0.88314     0.60052      0.5414     0.55064     0.81093     0.71689     0.55151      1.1297     0.93572      0.9272     0.50313     0.64629     0.53858     0.54636     0.59069     0.53643     0.95071      0.6882     0.82404     0.84536     0.60535     0.53285     0.79201     0.97742     0.60316     0.59674     0.73135     0.52422      0.6553     0.57042     0.67227     0.71992     0.79249     0.61514      0.5448     0.54432     0.66261     0.51298     0.50679     0.51277     0.51363     0.55859     0.64344     0.95226     0.79307     0.51549     0.60536      0.6946     0.63669     0.63806      0.6777     0.51033     0.56111     0.71386     0.93962     0.56469      0.8608     0.67175     0.52265     0.51618     0.88612      0.5654     0.57409     0.51234     0.68073     0.62671     0.56708      0.6389     0.76571     0.50188     0.65772     0.60341     0.62427     0.55459     0.54746     0.58546      0.5549     0.54668     0.60531     0.62246     0.51919     0.77055      1.3029     0.79127      0.5914     0.93181     0.65157     0.51109     0.71325      0.5091      1.0619     0.54216     0.60019      0.6991     0.50671     0.50017      0.5036      0.5658     0.53332     0.60293     0.76089     0.62648     0.80534     0.79314     0.51406     0.55473     0.88179     0.51841     0.53215     0.60803     0.58025     0.61974     0.74956     0.55991      0.5049     0.88044     0.57621     0.50261     0.55679     0.60215     0.71038     0.64878     0.84643     0.62677     0.56852     0.61755     0.77034     0.57314     0.61964     0.57479     0.55332     0.73631     0.57101      0.5069     0.53506     0.58918     0.76469     0.58267     0.72227     0.53397     0.75609     0.63435     0.86384     0.55608     0.62086     0.55818      0.5254     0.59215     0.56873      0.6859     0.70671      0.5255     0.67355      0.5086     0.54567     0.66199      0.5083     0.68702     0.54391     0.56026     0.50623     0.51791     0.53956      0.5234     0.50611     0.75597     0.79852     0.53988     0.54846     0.50301     0.57277     0.67939     0.78514     0.55168     0.58007     0.69378     0.95439     0.58049     0.70728     0.84871     0.51182      0.5746     0.76374     0.51728     0.64169      0.7225     0.51455      0.7369     0.53759      0.5153     0.75757     0.52243     0.51154     0.61396      0.6498     0.60951      0.7692     0.54654     0.55787     0.65441     0.79677     0.71462     0.50832     0.50012     0.84069     0.60018      0.5286     0.55217     0.56782     0.55158     0.64065     0.54479     0.59208     0.57619     0.66181     0.56808     0.50254     0.62454     0.64298     0.74492     0.62789     0.57902     0.56172     0.53478     0.70137     0.50137     0.56429     0.61199     0.51709     0.53137     0.51573     0.63184     0.53221     0.50538     0.50614      0.6783];
% 1479 - 3404
wd2 = [1493  1494  1500  1505  1512  1514  1517  1518  1528  1532  1540  1544  1549  1561  1570  1571  1572  1577  1578  1584  1585  1589  1598  1602  1603  1612  1614  1623  1642  1648  1651  1654  1661  1663  1665  1678  1683  1694  1697  1698  1702  1707  1711  1712  1713  1714  1719  1741  1746  1757  1758  1761  1775  1779  1781  1784  1786  1808  1809  1810  1822  1825  1833  1834  1845  1848  1858  1864  1867  1873  1876  1878  1881  1888  1889  1898  1901  1912  1914  1921  1923  1926  1931  1947  1954  1968  1987  1988  1991  1996  2000  2002  2006  2007  2008  2013  2021  2025  2313  2314  2326  2328  2337  2339  2344  2349  2351  2368  2379  2388  2390  2407  2413  2414  2426  2435  2437  2439  2447  2450  2451  2467  2474  2481  2505  2508  2517  2525  2529  2534  2545  2556  2560  2561  2565  2566  2567  2570  2585  2594  2597  2601  2604  2608  2612  2615  2619  2630  2645  2652  2656  2663  2669  2670  2677  2678  2689  2693  2698  2706  2718  2724  2726  2731  2732  2744  2746  2747  2748  2754  2763  2764  2767  2779  2784  2788  2789  2790  2796  2803  2804  2813  2823  2832  2834  2838  2841  2857  2859  2860  2866  2882  2888  2891  2895  2896  2897  2909  2910  2913  2914  2932  2933  2951  2952  2959  2981  2989  2990  2993  2998  3004  3009  3017  3019  3031  3033  3036  3042  3048  3051  3062  3064  3074  3082  3083  3090  3094  3095  3108  3112  3113  3119  3136  3147  3153  3156  3162  3193  3210  3220  3224  3236  3238  3246  3253  3262  3263  3265  3267  3275  3306  3309  3313  3319  3327  3330  3334  3341  3351  3357  3359  3363  3369  3396];
wdr2 = [0.5531     0.54567     0.53567     0.52806     0.79758     0.52143     0.56785     0.52178     0.75132      0.5586     0.50174     0.62144     0.55533     0.78203      0.6126     0.58175     0.55531      0.6546     0.62102     0.60675     0.59312     0.64414     0.78909     0.59902     0.65083     0.70687     0.84186     0.57276     0.52167     0.54797     0.75445     0.79279     0.50297     0.83593     0.56272     0.50954     0.59771     0.53757     0.73568     0.56192     0.55483     0.55801     0.68014     0.54647     0.55973     0.64913     0.74554     0.56278     0.53324     0.51717     0.61466     0.56947     0.53993     0.50036     0.50636     0.68863     0.82305     0.50246     0.51376     0.57377     0.55754     0.74954     0.55732     0.55452     0.52726     0.72373     0.55604     0.55039     0.66623     0.85834     0.69404     0.52053     0.51004     0.67466     0.56819     0.67531     0.53287     0.55928     0.55661     0.59781     0.55184     0.54909     0.54518     0.52615      0.5583     0.55182     0.52457     0.59501     0.68448     0.58852     0.50275     0.79122     0.60357      0.5747     0.50904     0.50352     0.60758      0.6717     0.65617     0.63529     0.50663     0.58346     0.50468     0.52576     0.54706     0.51247     0.56477     0.53912     0.52611     0.56582     0.50836      0.6751     0.51142      0.5151     0.53503     0.50696     0.51349     0.51953      0.7055      1.1763     0.55094     0.57387     0.54662     0.52628     0.52104     0.50512     0.50176     0.53267     0.51133     0.51561     0.57693     0.59751     0.53136     0.51867     0.53643     0.51971     0.59435     0.50078     0.53896     0.53421     0.64442     0.50482     0.52448     0.74678     0.53142     0.84143     0.54497     0.59614      0.5122     0.58604     0.52607     0.54172     0.53622      0.5021     0.59296     0.55893     0.53605     0.65086     0.51723     0.64123     0.63329     0.52364     0.54057     0.67749     0.50557     0.60343     0.52257     0.62975     0.57445     0.56153     0.68208      0.5124     0.61325      0.7665     0.52056     0.52157     0.52578     0.50514     0.64085     0.76526     0.57378     0.66713     0.53299     0.57815     0.50624     0.50634     0.50789     0.56787     0.50671     0.68739     0.50522     0.53605     0.71756     0.51213     0.53792     0.65774     0.73889     0.55199     0.63918     0.60386     0.56927     0.54281     0.54914     0.53749      0.5247     0.53309     0.57431      0.6083     0.57465     0.51478     0.51172     0.54057     0.59263     0.51538     0.59239     0.52655     0.56617      0.5215      0.5389     0.51369     0.54549     0.72945     0.50063     0.51786     0.69909     0.55675     0.51503     0.50936      0.9313     0.51234     0.53592     0.51636     0.67668     0.51965     0.50242     0.55193     0.57398     0.58608     0.52906     0.61351     0.51728     0.58582       1.036     0.50193     0.50306     0.62121     0.64189     0.64386     0.53424     0.62942     0.54269     0.68018     0.54803     0.51018     0.58772     0.51505     0.50166     0.53795     0.60745     0.67783     0.54711      0.6502     0.66894     0.54132     0.55191];

% 7 - 3403
bd = [7     9    14    15    20    21    23    25    27    29    32    34    36    38    44    46    47    54    57    58    61    62    63    68    76    77    78    82    87    90   102   106   107   108   109   113   116   121   139   140   144   153   154   156   159   161   164   169   170   171   173   175   176   193   196   206   209   213   220   225   227   231   239   241   244   252   257   264   265   267   269   271   273   278   279   283   291   293   303   331   333   341   343   348   352   353   359   360   371   373   376   379   382   383   390   391   395   404   409   411   412   413   418   426   433   434   445   447   453   460   467   476   478   482   489   490   494   507   514   524   526   529   530   531   532   534   535   536   551   554   556   568   573   576   580   583   592   601   605   609   613   629   636   643   645   669   671   682   689   699   703   708   714   715   716   719   720   723   738   742   750   758   764   767   768   771   773   777   781   784   786   790   801   802   804   809   812   825   826   835   837   840   841   846   853   854   867   868   872   873   879   885   888   890   893   895   898   905   906   909   910   914   926   933   940   941   943   944   950   957   964   970   973   975   986   987   991   999  1000  1002  1008  1033  1035  1046  1052  1053  1059  1060  1062  1071  1073  1077  1080  1084  1085  1088  1095  1097  1124  1131  1134  1144  1145  1147  1154  1156  1160  1161  1173  1176  1179  1191  1199  1222  1225  1232  1235  1236  1242  1246  1252  1255  1256  1263  1264  1266  1267  1269  1270  1274  1277  1279  1288  1290  1296  1303  1307  1314  1330  1334  1338  1339  1341  1348  1351  1360  1361  1363  1380  1385  1392  1396  1398  1408  1426  1434  1435  1441  1452  1461  1468  1485  1496  1498  1504  1520  1524  1534  1541  1550  1558  1563  1574  1582  1590  1594  1596  1604  1605  1608  1611  1613  1617  1620  1624  1630  1631  1640  1652  1655  1664  1673  1674  1686  1687  1689  1691  1701  1709  1720  1722  1736  1740  1743  1751  1753  1755  1762  1764  1766  1773  1782  1787  1790  1796  1804  1805  1814  1826  1836  1838  1844  1846  1853  1856  1857  1868  1869  1874  1883  1886  1887  1892  1894  1895  1902  1935  1937  1943  1950  1951  1953  1956  1957  1959  1960  1972  1978  1980  1981  1984  1986  1992  1994  1999  2001  2003  2009  2010  2011  2016  2033  2310  2341  2355  2356  2357  2362  2372  2376  2378  2386  2387  2398  2400  2418  2420  2421  2441  2462  2466  2471  2479  2484  2487  2488  2503  2504  2509  2538  2557  2562  2578  2609  2613  2633  2639  2643  2653  2660  2684  2696  2701  2703  2704  2721  2729  2742  2766  2771  2777  2778  2793  2794  2802  2809  2810  2843  2844  2855  2864  2877  2886  2887  2893  2901  2923  2930  2938  2961  2984  2985  2991  2994  3001  3015  3028  3035  3041  3047  3050  3055  3056  3070  3071  3073  3076  3085  3097  3104  3106  3107  3109  3114  3116  3124  3128  3138  3144  3161  3175  3179  3219  3222  3248  3255  3286  3288  3291  3292  3296  3298  3310  3312  3325  3333  3361  3365  3374  3388  3389  3398  3403];
bdr = [0.71507     0.73684     0.62509     0.81406       1.068     0.70036     0.58742     0.58357     0.90092     0.82596     0.72993     0.51256      1.0682      0.5761     0.61414      0.8229     0.54783      1.3111       0.801      0.8807     0.96825     0.65835     0.54181     0.63383     0.78269     0.79115     0.59441     0.65209      1.1494     0.54067     0.59273     0.51205     0.50443     0.80185     0.61912     0.50311      1.0289     0.51642     0.69152     0.58597     0.72638     0.74563     0.65402     0.54657     0.51257     0.52523     0.70973     0.62813     0.62296     0.53588     0.55628     0.64642      1.1971     0.51479     0.59694     0.55016     0.51406     0.63448      0.6055     0.84764     0.56968     0.62674     0.55257      0.6177     0.50324     0.60445     0.71906     0.52486     0.62878      0.8042     0.74912     0.70798     0.54225     0.94634     0.62118     0.55674     0.50917     0.60621     0.50741     0.63847     0.55258     0.62065     0.54582     0.62245     0.55085     0.50804      0.5749     0.51717     0.66027     0.84059     0.53261     0.60018     0.56319     0.62403     0.52401     0.61498     0.50087     0.50008     0.60348      0.6543     0.65629     0.55373       0.696     0.55156     0.51818     0.66997     0.50231     0.88962     0.74016     0.69867     0.55234      0.5105      0.7006      1.1425     0.55437     0.73278     0.60464     0.51591      1.2071     0.64692     0.91744     0.51418     0.64951      0.5063     0.51942     0.96415     0.78492      0.5712     0.50859     0.79044     0.59756     0.56358     0.51928     0.53666     0.78781     0.73086      0.5856     0.68071     0.63042     0.52618     0.52531     0.51526     0.61475     0.52189     0.86505     0.77669     0.59828     0.73732     0.74253     0.50519     0.59119     0.70256     0.57022     0.50664     0.64294     0.72799     0.69941      0.8477     0.72488     0.66838     0.62518     0.51768     0.50837     0.51291      0.8078     0.77345     0.58718     0.66528     0.50802     0.59352     0.53531       0.634      0.6165     0.51304     0.68224     0.57308      0.7118     0.58007     0.77265     0.50662     0.58774     0.56967     0.80305     0.56679     0.59987     0.52605     0.51964     0.50836     0.78724     0.69996     0.63873     0.54846     0.60782     0.57425     0.63576      0.5186     0.67511     0.54477     0.57712     0.51521     0.55186     0.64385     0.62332     0.50515     0.63795      0.5681     0.63897       0.668     0.54941     0.50563     0.56013     0.53927     0.73937     0.66379     0.53262     0.60826     0.60282     0.58251      0.5145     0.62127     0.53666     0.50009     0.83387     0.51567     0.55382     0.56086     0.52152     0.94657     0.65935      0.5573     0.57343     0.58135     0.67618     0.53567      0.6429     0.65385     0.50476     0.66363     0.65994     0.65268     0.62321     0.52499     0.53083      0.5556     0.55894      1.0536     0.51558     0.58136     0.51887     0.75055     0.56813     0.61021     0.60946     0.53815     0.63144      0.6809     0.52807     0.64923     0.54973     0.50909     0.59051     0.51194     0.65865     0.72633     0.81136     0.56096     0.51553     0.63398     0.53934     0.57422     0.64334     0.61812     0.52776     0.58803      0.6592     0.55408     0.51604     0.74384     0.61167     0.68598     0.72867     0.82687     0.53862     0.52348     0.55043     0.59455      0.5908     0.56154     0.63453      0.5056     0.50179     0.51153     0.52829     0.64593     0.54459      0.6465     0.52892     0.72299     0.58093     0.59818     0.53865     0.51924     0.56836     0.52982     0.55352     0.59877     0.56997     0.59549     0.68556     0.63379     0.65286     0.63033     0.57235     0.71562      0.6063     0.55136     0.53098     0.53675     0.51327     0.51226     0.52579     0.54892     0.61984     0.51325      0.5027     0.61558     0.59682     0.59323     0.53284     0.82515     0.71185     0.51116     0.56005     0.51493     0.61468     0.57573     0.53925     0.60952     0.58918     0.52982     0.55656      0.5433     0.56592     0.51558      0.5121     0.55709     0.60283      0.5505     0.50983     0.62462     0.50172     0.72447     0.53166     0.73566     0.54888     0.65252     0.54189     0.53753      0.5127     0.58184     0.55772     0.54191     0.51421     0.60502      0.6325     0.57897     0.62933      0.5353     0.54977     0.50664     0.55189     0.98453     0.75127     0.51288     0.84274     0.60328     0.56646     0.57933     0.52617     0.70528     0.54756     0.70835     0.73579     0.52791     0.74479     0.50264     0.51899     0.50962     0.76576     0.50072     0.60838     0.52594     0.52961     0.52871     0.57204     0.50002     0.51778     0.60005     0.55768     0.88453     0.57898     0.55019     0.61116     0.57854     0.53296     0.57041     0.82992     0.59507     0.56631     0.50382     0.56845     0.62981     0.69856     0.52454     0.84488     0.58578     0.52538     0.53248     0.52487     0.60722     0.58328     0.88122     0.53378      0.5382     0.78162     0.50247     0.54849     0.58989     0.62593     0.50685     0.53405     0.59517     0.55808     0.55705     0.83868     0.55702     0.54315     0.77031     0.63769     0.61527     0.58063     0.57022     0.54847     0.50459     0.74752      0.5245     0.53232     0.57114      0.5059     0.51451     0.51161     0.51035     0.54823     0.53499     0.51768      0.7523     0.65931     0.54095     0.59542     0.55353     0.69505     0.57872     0.63584      0.5083     0.62208     0.58002     0.65845     0.51902     0.53576     0.66304     0.83987     0.54357     0.56228     0.51252     0.50383     0.61842     0.52008     0.54889     0.69512     0.53017     0.51315     0.54296     0.68942     0.52152     0.52626     0.55519     0.50402     0.54029     0.51585     0.66748     0.52028     0.56706     0.58195     0.59153     0.53541     0.51906     0.50575     0.56217     0.59788      0.5571     0.51855      0.5332      0.5177     0.51079     0.55143     0.53993     0.54602     0.58521     0.52272     0.51852     0.73772     0.52724     0.64601     0.54833     0.53962     0.55442     0.61057     0.57292     0.52336     0.50032     0.55544     0.53074      0.7377];

% combine responses and ROIs into two complete lists (note: this will mix
% them and just have one list for all dual-responsive ROIs; if this is
% problematic just use the above lists^

dualROI = [wd1 wd2 bd];
dualResp = [wdr1 wdr2 bdr];
%% create arrays of ONLY black/white response
onlyBROI = [];
onlyBResp = [];
onlyWROI = [];
onlyWResp = [];

% loop thru original black&white lists
% black list
for i=1:length(bROI)
    if ~any(bROI(i)==dualROI) % this ROI is not in dualROI
        onlyBROI = [onlyBROI ; bROI(i)];
        onlyBResp = [onlyBResp ; bResp(i)];
    end
end

% white list
for i=1:length(wROI)
    if ~any(wROI(i)==dualROI) % this ROI is not in dualROI
        onlyWROI = [onlyWROI ; wROI(i)];
        onlyWResp = [onlyWResp ; wResp(i)];
    end
end

%% plot: graph BW responsive ROIs on average image

disp('Plotting...');
% boundary cutoffs
minDistM = 5;
minDistRightM = 10;

% convert microns to pixels
minDistP = ceil(minDistM/eROI.micronsPerPix);
minDistRightP = ceil(minDistRightM/eROI.micronsPerPix);

% apply new zscore cutoff if wanted
newCutoff = 0.50;

% black graph
figure(2);
clf;
fullLandscapePaperSize;
imagesc(eROI.avgImage, [360 2500]);
colormap bone;
hold on;
nB=0;
% % black response
% for i=1:length(onlyBROI)
%     % take x and y coords of each responsive ROI
%     xBound = eROI.roi(onlyBROI(i)).pos.somaBoundary(:,1);
%     yBound = eROI.roi(onlyBROI(i)).pos.somaBoundary(:,2);
%     % apply new cutoff
%     if onlyBResp(i) >= newCutoff
%         % exclude ROIs on edge
%         if min(xBound) > minDistP && max(xBound) <= size(eROI.avgImage,2)-minDistRightP && ...
%                 min(yBound) > minDistP && max(yBound) <= size(eROI.avgImage,1)-minDistP
%             % plot
%             line(xBound,yBound,'Color', '#4dbeee','LineWidth',2);
%             nB = nB+1;
%         end
%     end
% end
% title(['Responsive ROIs to Black Sparse Noise, N = ',num2str(nB),', Z-score cutoff = ',num2str(newCutoff)]);
axis tight;
hold off;

% white graph
figure(3);
clf;
fullLandscapePaperSize;
imagesc(eROI.avgImage, [360 2500]);
colormap bone;
hold on;
nW = 0;
for i=1:length(onlyWROI)
    
    % take x and y coords of each responsive ROI
    xBound = eROI.roi(onlyWROI(i)).pos.somaBoundary(:,1);
    yBound = eROI.roi(onlyWROI(i)).pos.somaBoundary(:,2);
    
    % apply new cutoff
    if onlyWResp(i) >= newCutoff
        % exclude ROIs on edge
        if min(xBound) > minDistP && max(xBound) <= size(eROI.avgImage,2)-minDistRightP && ...
                min(yBound) > minDistP && max(yBound) <= size(eROI.avgImage,1)-minDistP
            % plot
            line(xBound,yBound,'Color', '#d95319','LineWidth',2);
            nW = nW+1;
        end
    end
end
title(['Responsive ROIs to White Sparse Noise, N = ',num2str(nW),', Z-score cutoff = ',num2str(newCutoff)]);
axis tight;
hold off;

% dual graph
figure(4);
clf;
fullLandscapePaperSize;
imagesc(eROI.avgImage, [360 2500]);
colormap bone;
hold on;
nDual=0;
% black response
for i=1:length(dualROI)
    % take x and y coords of each responsive ROI
    xBound = eROI.roi(dualROI(i)).pos.somaBoundary(:,1);
    yBound = eROI.roi(dualROI(i)).pos.somaBoundary(:,2);
    % apply new cutoff
    if dualResp(i) >= newCutoff
        % exclude ROIs on edge
        if min(xBound) > minDistP && max(xBound) <= size(eROI.avgImage,2)-minDistRightP && ...
                min(yBound) > minDistP && max(yBound) <= size(eROI.avgImage,1)-minDistP
            % plot
            line(xBound,yBound,'Color', '#77AC30','LineWidth',2);
            nDual = nDual+1;
        end
    end
end
title(['Responsive ROIs to Both Sparse Noises, N = ',num2str(nDual),', Z-score cutoff = ',num2str(newCutoff)]);
axis tight;
hold off;

disp('Done plotting.');

%% plot density

disp('Plotting heat maps...');
warning('off','MATLAB:polyshape:repairedBySimplify');

% boundary cutoffs
minDistM = 5;
minDistRightM = 10;

% convert microns to pixels
minDistP = ceil(minDistM/eROI.micronsPerPix);
minDistRightP = ceil(minDistRightM/eROI.micronsPerPix);

% apply new zscore cutoff if wanted
newCutoff = .50;

% HISTOGRAM PLOTS

% histogram dimensions

bins = 30;

figure(4);
clf;
fullLandscapePaperSize;
colormap default;

% black graph
p1 = subplot(3,2,1);
clear title xlabel ylabel;
nB=0;
histList1=[];
% black response
for i=1:length(onlyBROI)
    % take x and y coords of each responsive ROI
    xBound = eROI.roi(onlyBROI(i)).pos.somaBoundary(:,1);
    yBound = eROI.roi(onlyBROI(i)).pos.somaBoundary(:,2);
    poly = polyshape(xBound,yBound);
    [x,y] = centroid(poly);
    % apply new cutoff
    if onlyBResp(i) >= newCutoff
        % exclude ROIs on edge
        if min(xBound) > minDistP && max(xBound) <= size(eROI.avgImage,2)-minDistRightP && ...
                min(yBound) > minDistP && max(yBound) <= size(eROI.avgImage,1)-minDistP
            histList1 = [histList1; [x,y]];
            nB = nB+1;
        end
    end
end
% plot
hist3(histList1,'Nbins', [bins bins],'CdataMode','auto');
shading interp;
colorbar;
title(['Responsive ROIs to Black Sparse Noise, N = ',num2str(nB),', Z-score cutoff = ',num2str(newCutoff)]);
xlabel('Pixels (3.01p = 1 micron)');
% ylabel('Pixels (3.01p = 1 micron)');
view(2);

% white graph
% imagesc(eROI.avgImage, [360 2500]);
p3=subplot(3,2,3);
clear title xlabel ylabel;
nW = 0;
histList3=[];
for i=1:length(onlyWROI)
    % take x and y coords of each responsive ROI
    xBound = eROI.roi(onlyWROI(i)).pos.somaBoundary(:,1);
    yBound = eROI.roi(onlyWROI(i)).pos.somaBoundary(:,2);
    poly = polyshape(xBound,yBound);
    [x,y] = centroid(poly);
    % apply new cutoff
    if onlyWResp(i) >= newCutoff
        % exclude ROIs on edge
        if min(xBound) > minDistP && max(xBound) <= size(eROI.avgImage,2)-minDistRightP && ...
                min(yBound) > minDistP && max(yBound) <= size(eROI.avgImage,1)-minDistP
            histList3 = [histList3; [x,y]];
            nW = nW+1;
        end
    end
end
% plot
hist3(histList3,'Nbins', [bins bins],'CdataMode','auto');
colorbar;
shading interp;
title(['Responsive ROIs to White Sparse Noise, N = ',num2str(nW),', Z-score cutoff = ',num2str(newCutoff)]);
xlabel('Pixels (3.01p = 1 micron)');
% ylabel('Pixels (3.01p = 1 micron)');
view(2);

% both graph
% imagesc(eROI.avgImage, [360 2500]);
p5 = subplot(3,2,5);
clear title xlabel ylabel;
nBoth = 0;
histList5=[];
for i=1:length(dualROI)
    % take x and y coords of each responsive ROI
    xBound = eROI.roi(dualROI(i)).pos.somaBoundary(:,1);
    yBound = eROI.roi(dualROI(i)).pos.somaBoundary(:,2);
    poly = polyshape(xBound,yBound);
    [x,y] = centroid(poly);
    % apply new cutoff
    if dualResp(i) >= newCutoff
        % exclude ROIs on edge
        if min(xBound) > minDistP && max(xBound) <= size(eROI.avgImage,2)-minDistRightP && ...
                min(yBound) > minDistP && max(yBound) <= size(eROI.avgImage,1)-minDistP
            histList5 = [histList5; [x,y]];%[double(xBound),double(yBound)]];
            nBoth = nBoth+1;
        end
    end
end
% plot
hist3(histList5,'Nbins', [bins bins],'CdataMode','auto');
shading interp;
view(2);
colorbar;
title(['Responsive ROIs to Both B&W Sparse Noise, N = ',num2str(nBoth),', Z-score cutoff = ',num2str(newCutoff)]);
xlabel('Pixels (3.01p = 1 micron)');
% ylabel('Pixels (3.01p = 1 micron)');

% INTERPOLATED PLOTS

% black resp interp
p2=subplot(3,2,2);
clear title xlabel ylabel;
[N,c] = hist3(histList1,'Nbins', [bins bins],'CdataMode','auto');
[a,b] = ndgrid(c{1},c{2});
F = griddedInterpolant(a,b,N,'linear','none');
[aq,bq] = ndgrid(0:4:512);
surf(aq,bq,F(aq,bq));
% inter3 = imagesc(aq(:,1), bq(:,1), F(aq,bq));
colorbar;
shading interp; % removes gridlines
title('Interpolated Density Plot');
xlabel('Pixels (3.01p = 1 micron)');
% ylabel('Pixels (3.01p = 1 micron)');
view(2);

% white resp interp
p4=subplot(3,2,4);
clear title xlabel ylabel;
[N,c] = hist3(histList3,'Nbins', [bins bins],'CdataMode','auto');
[a,b] = ndgrid(c{1},c{2});
F = griddedInterpolant(a,b,N,'linear','none');
[aq,bq] = ndgrid(0:4:512);
surf(aq,bq,F(aq,bq));
% inter3 = imagesc(aq(:,1), bq(:,1), F(aq,bq));
colorbar;
shading interp; % removes gridlines
title('Interpolated Density Plot');
xlabel('Pixels (3.01p = 1 micron)');
% ylabel('Pixels (3.01p = 1 micron)');
view(2);

% dual resp interp
p6=subplot(3,2,6);
clear title xlabel ylabel;
[N,c] = hist3(histList5,'Nbins', [bins bins],'CdataMode','auto');
[a,b] = ndgrid(c{1},c{2});
F = griddedInterpolant(a,b,N,'linear','none');
[aq,bq] = ndgrid(0:4:512);
surf(aq,bq,F(aq,bq));
% inter3 = imagesc(aq(:,1), bq(:,1), F(aq,bq));
colorbar;
shading interp; % removes gridlines
title('Interpolated Density Plot');
xlabel('Pixels (3.01p = 1 micron)');
% ylabel('Pixels (3.01p = 1 micron)');
view(2);

disp('Done plotting.');
